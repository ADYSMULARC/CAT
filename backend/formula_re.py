# -*- coding: utf-8 -*-
"""
Created on Thu Nov 16 17:25:26 2017

@author: jeanchen
"""

formula_reg = '(accrint\()|(accrintm\()|(acos\()|(acosh\()|(acot\()|(acoth\()|(aggregate\()|(address\()|(amordegrc\()|(amorlinc\()|(and\()|(arabic\()|(areas\()|(asc\()|(asin\()|(asinh\()|(atan\()|(atan2\()|(atanh\()|(avedev\()|(average\()|(averagea\()|(averageif\()|(averageifs\()|(bahttext\()|(base\()|(besseli\()|(besselj\()|(besselk\()|(bessely\()|(betadist\()|(beta\.dist\()|(betainv\()|(beta\.inv\()|(bin2dec\()|(bin2hex\()|(bin2oct\()|(binomdist\()|(binom\.dist\()|(binom\.dist\.range\()|(binom\.inv\()|(bitand\()|(bitlshift\()|(bitor\()|(bitrshift\()|(bitxor\()|(call\()|(ceiling\()|(ceiling\.math\()|(ceiling\.precise\()|(cell\()|(char\()|(chidist\()|(chiinv\()|(chitest\()|(chisq\.dist\()|(chisq\.dist\.rt\()|(chisq\.inv\()|(chisq\.inv\.rt\()|(chisq\.test\()|(choose\()|(clean\()|(code\()|(column\()|(columns\()|(combin\()|(combina\()|(complex\()|(concat\()|(concatenate\()|(confidence\()|(confidence\.norm\()|(confidence\.t\()|(convert\()|(correl\()|(cos\()|(cosh\()|(cot\()|(coth\()|(count\()|(counta\()|(countblank\()|(countif\()|(countifs\()|(coupdaybs\()|(coupdays\()|(coupdaysnc\()|(coupncd\()|(coupnum\()|(couppcd\()|(covar\()|(covariance\.p\()|(covariance\.s\()|(critbinom\()|(csc\()|(csch\()|(cubekpimember\()|(cubemember\()|(cubememberproperty\()|(cuberankedmember\()|(cubeset\()|(cubesetcount\()|(cubevalue\()|(cumipmt\()|(cumprinc\()|(date\()|(datedif\()|(datevalue\()|(daverage\()|(day\()|(days\()|(days360\()|(db\()|(dbcs\()|(dcount\()|(dcounta\()|(ddb\()|(dec2bin\()|(dec2hex\()|(dec2oct\()|(decimal\()|(degrees\()|(delta\()|(devsq\()|(dget\()|(disc\()|(dmax\()|(dmin\()|(dollar\()|(dollarde\()|(dollarfr\()|(dproduct\()|(dstdev\()|(dstdevp\()|(dsum\()|(duration\()|(dvar\()|(dvarp\()|(edate\()|(effect\()|(encodeurl\()|(eomonth\()|(erf\()|(erf\.precise\()|(erfc\()|(erfc\.precise\()|(error\.type\()|(euroconvert\()|(even\()|(exact\()|(exp\()|(expon\.dist \()|(expondist\()|(fact\()|(factdouble\()|(false\()|(f\.dist\()|(fdist\()|(f\.dist\.rt\()|(filterxml\()|(find\()|(f\.inv\()|(f\.inv\.rt\()|(finv\()|(fisher\()|(fisherinv\()|(fixed\()|(floor\()|(floor\.math\()|(floor\.precise\()|(forecast\()|(forecast\.ets\()|(forecast\.ets\.confint\()|(forecast\.ets\.seasonality\()|(forecast\.ets\.stat\()|(forecast\.linear\()|(formulatext \()|(frequency\()|(f\.test \()|(ftest\()|(fv\()|(fvschedule\()|(gamma\()|(gamma\.dist \()|(gammadist\()|(gamma\.inv \()|(gammainv\()|(gammaln\()|(gammaln\.precise\()|(gauss\()|(gcd\()|(geomean\()|(gestep\()|(getpivotdata\()|(growth\()|(harmean\()|(hex2bin\()|(hex2dec\()|(hex2oct\()|(hlookup\()|(hour\()|(hyperlink\()|(hypgeom\.dist\()|(hypgeomdist\()|(if\()|(iferror\()|(ifna\()|(ifs\()|(imabs\()|(imaginary\()|(imargument\()|(imconjugate\()|(imcos\()|(imcosh \()|(imcot \()|(imcsc \()|(imcsch \()|(imdiv\()|(imexp\()|(imln\()|(imlog10\()|(imlog2\()|(impower\()|(improduct\()|(imreal\()|(imsec \()|(imsech \()|(imsin\()|(imsinh \()|(imsqrt\()|(imsub\()|(imsum\()|(imtan \()|(index\()|(indirect\()|(info\()|(int\()|(intercept\()|(intrate\()|(ipmt\()|(irr\()|(isblank\()|(iserr\()|(iserror\()|(iseven\()|(isformula \()|(islogical\()|(isna\()|(isnontext\()|(isnumber\()|(isodd\()|(isref\()|(istext\()|(iso\.ceiling \()|(isoweeknum \()|(ispmt\()|(jis\()|(kurt\()|(large\()|(lcm\()|(left\()|(len\()|(linest\()|(ln\()|(log\()|(log10\()|(logest\()|(loginv\()|(lognorm\.dist\()|(lognormdist\()|(lognorm\.inv\()|(lookup\()|(lower\()|(match\()|(max\()|(maxa\()|(maxifs \()|(mdeterm\()|(mduration\()|(median\()|(mid\()|(min\()|(minifs \()|(mina\()|(minute\()|(minverse\()|(mirr\()|(mmult\()|(mod\()|(mode\()|(mode\.mult\()|(mode\.sngl\()|(month\()|(mround\()|(multinomial\()|(munit\()|(n\()|(na\()|(negbinom\.dist \()|(negbinomdist\()|(networkdays\()|(networkdays\.intl \()|(nominal\()|(norm\.dist \()|(normdist\()|(norminv\()|(norm\.inv \()|(norm\.s\.dist \()|(normsdist\()|(norm\.s\.inv \()|(normsinv\()|(not\()|(now\()|(nper\()|(npv\()|(numbervalue \()|(oct2bin\()|(oct2dec\()|(oct2hex\()|(odd\()|(oddfprice\()|(oddfyield\()|(oddlprice\()|(oddlyield\()|(offset\()|(or\()|(pduration\()|(pearson\()|(percentile\.exc\()|(percentile\.inc\()|(percentile\()|(percentrank\.exc\()|(percentrank\.inc\()|(percentrank\()|(permut\()|(permutationa\()|(phi\()|(phonetic\()|(pi\()|(pmt\()|(poisson\.dist\()|(poisson\()|(power\()|(ppmt\()|(price\()|(pricedisc\()|(pricemat\()|(prob\()|(product\()|(proper\()|(pv\()|(quartile\()|(quartile\.exc\()|(quartile\.inc\()|(quotient\()|(radians\()|(rand\()|(randbetween\()|(rank\.avg\()|(rank\.eq\()|(rank\()|(rate\()|(received\()|(register\.id\()|(replace\()|(rept\()|(right\()|(roman\()|(round\()|(rounddown\()|(roundup\()|(row\()|(rows\()|(rri\()|(rsq\()|(rtd\()|(search\()|(sec\()|(sech\()|(second\()|(seriessum\()|(sheet\()|(sheets\()|(sign\()|(sin\()|(sinh\()|(skew\()|(skew\.p\()|(sln\()|(slope\()|(small\()|(sql\.request\()|(sqrt\()|(sqrtpi\()|(standardize\()|(stdev\()|(stdev\.p\()|(stdev\.s\()|(stdeva\()|(stdevp\()|(stdevpa\()|(steyx\()|(substitute\()|(subtotal\()|(sum\()|(sumif\()|(sumifs\()|(sumproduct\()|(sumsq\()|(sumx2my2\()|(sumx2py2\()|(sumxmy2\()|(switch\()|(syd\()|(t\()|(tan\()|(tanh\()|(tbilleq\()|(tbillprice\()|(tbillyield\()|(t\.dist\()|(t\.dist\.2t\()|(t\.dist\.rt\()|(tdist\()|(text\()|(textjoin\()|(time\()|(timevalue\()|(t\.inv\()|(t\.inv\.2t\()|(tinv\()|(today\()|(transpose\()|(trend\()|(trim\()|(trimmean\()|(true\()|(trunc\()|(t\.test\()|(ttest\()|(type\()|(unichar\()|(unicode\()|(upper\()|(value\()|(var\()|(var\.p\()|(var\.s\()|(vara\()|(varp\()|(varpa\()|(vdb\()|(vlookup\()|(webservice\()|(weekday\()|(weeknum\()|(weibull\()|(weibull\.dist\()|(workday\()|(workday\.intl\()|(xirr\()|(xnpv\()|(xor\()|(year\()|(yearfrac\()|(yield\()|(yielddisc\()|(yieldmat\()|(z\.test\()|(ztest\()'